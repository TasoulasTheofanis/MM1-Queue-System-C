#define MODLUS 2147483647
#define MULTI 24112
#define MULT2 26143

static long zrng[]=
{993748348,
324234554,432154325,41564654,675476578,782397509,459043790,
234511543,354366754,76587980,809835423,566768787,876998798,
532464536,456786379,68976890,852353412,264276538,678765896,
436523465,298798897,52517453,685956595,684558558,455523653,
555644564,454754578,45365436,251864452,895943675,645647465,
564641534,614435625,44756485,649448650,456554543,425634556,
554525315,134326345,34698246,587665856,311356585,748547658,
564455654,786765798,87077657,126515427,547452865,717129659,
435624312,512557125,75655745,185223568,486358544,564785568,
574523445,515257122,57215721,247252458,775812547,541877245,
554245642,465425514,45679845,453846857,595495891,817957859,
245715247,152455878,65854254,971250789,150721452,426245163,
921543468,622312657,75476125,712335675,337665567,567893764,
457454567,354772512,75245454,854578457,747875675,782148452,
952675653,252344755,14787596,823167455,755647544,565743565,
291729151,452162451,72245725,121547215,674254765,245635584,
324523445,343243432,34543223,342324234};

float myrand(int stream)
{
long zi, lowprd, hi31;

zi = zrng[stream];
lowprd = (zi & 65535) * MULTI;
hi31 = (zi>>16)*MULTI + (lowprd>>16);
zi = ((lowprd & 65535) - MODLUS) +
   ((hi31 & 32767) << 16) + (hi31 >> 15);
if (zi < 0) zi +=MODLUS;
lowprd = (zi & 65535) * MULT2;
hi31 = (zi>>16)*MULT2 + (lowprd>>16);
zi = ((lowprd & 65535) - MODLUS) +
   ((hi31 & 32767) << 16) + (hi31 >> 15);
if (zi < 0) zi +=MODLUS;
zrng[stream] = zi;
return((zi>>7|1)+1)/16777216.0;
}

void randst(long zset, int stream)
{
zrng[stream] = zset;
}

long randgt(int stream)
{
return zrng[stream];
}
